<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Verben mit Pr√§positionen ‚Ä¢ –¢—Ä–µ–Ω–∞–∂–µ—Ä</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="min-h-dvh bg-slate-50 dark:bg-slate-900 text-slate-900 dark:text-slate-100">
  <main class="max-w-3xl mx-auto p-4 sm:p-6">
    <header class="mb-6 sm:mb-8 text-center">
      <h1 class="text-3xl font-bold">Verben mit Pr√§positionen</h1>
      <p class="text-sm sm:text-base text-slate-600 dark:text-slate-400">DE ‚Üí UA —Ç—Ä–µ–Ω–∞–∂–µ—Ä: –æ–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø—Ä–∏–π–º–µ–Ω–Ω–∏–∫. –ü–æ–∫–∞–∑–∞–Ω–æ –¥—ñ—î—Å–ª–æ–≤–æ, —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π –ø–µ—Ä–µ–∫–ª–∞–¥ —ñ —Ç–∏–ø–æ–≤–∏–π –≤—ñ–¥–º—ñ–Ω–æ–∫.</p>
    </header>

    <!-- SETUP -->
    <section id="setupCard" class="bg-white dark:bg-slate-800 rounded-3xl p-5 sm:p-7 shadow">
      <h2 class="text-lg font-semibold mb-3">–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Ç–µ—Å—Ç—É</h2>
      <div class="flex flex-col gap-3 sm:flex-row sm:items-end sm:gap-4">
        <label class="flex-1">
          <span class="block text-sm mb-1">–°–∫—ñ–ª—å–∫–∏ –ø–∏—Ç–∞–Ω—å –ø–æ–∫–∞–∑–∞—Ç–∏?</span>
          <input id="questionCount" type="number" min="5" max="100" value="20" class="w-full rounded-2xl border border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 px-4 py-3" />
        </label>
        <div class="flex flex-wrap gap-2">
          <button id="startBtn" class="rounded-2xl px-4 py-2 shadow bg-indigo-600 text-white">–ü–æ—á–∞—Ç–∏ —Ç–µ—Å—Ç</button>
          <button id="repeatMistakesBtn" class="rounded-2xl px-4 py-2 shadow bg-amber-500 text-white">–ü–æ–≤—Ç–æ—Ä–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ üîÅ</button>
          <button id="resetProgressBtn" class="rounded-2xl px-4 py-2 shadow bg-rose-600 text-white">–°–∫–∏–Ω—É—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å üóëÔ∏è</button>
        </div>
      </div>
      <div class="mt-3 text-sm text-slate-600 dark:text-slate-300" id="masteredInfo"></div>
      <details class="mt-4">
        <summary class="cursor-pointer text-sm text-slate-600 dark:text-slate-400">–ü—ñ–¥–∫–∞–∑–∫–∞</summary>
        <div class="mt-2 text-sm text-slate-700 dark:text-slate-300">
          –ü—Ä–∏–∫–ª–∞–¥–∏: warten <b>auf</b> + Akk, tr√§umen <b>von</b> + Dat, sprechen <b>mit</b> + Dat / <b>√ºber</b> + Akk.
        </div>
      </details>
    </section>

    <!-- QUIZ -->
    <section id="quizCard" class="hidden mt-6 bg-white dark:bg-slate-800 rounded-3xl p-5 sm:p-7 shadow">
      <div class="flex items-center justify-between mb-4">
        <div id="progress" class="text-sm text-slate-600 dark:text-slate-300">0 / 0</div>
        <div id="scoreMini" class="inline-flex items-center rounded-full px-3 py-1 text-sm font-medium bg-slate-100 dark:bg-slate-700">‚úÖ 0</div>
      </div>

      <div id="questionBox" class="space-y-3">
        <div class="text-sm text-slate-500">–î—ñ—î—Å–ª–æ–≤–æ ‚Ä¢ –ü–µ—Ä–µ–∫–ª–∞–¥ ‚Ä¢ –í—ñ–¥–º—ñ–Ω–æ–∫</div>
        <h3 id="prompt" class="text-xl font-semibold"></h3>
        <div id="options" class="grid grid-cols-2 sm:grid-cols-3 gap-3"></div>
      </div>

      <div id="feedback" class="hidden mt-4 rounded-2xl border p-3"></div>
      <p class="mt-4 text-sm text-slate-500 dark:text-slate-400">–ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –≤–∞—Ä—ñ–∞–Ω—Ç ‚Äî –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ.</p>
    </section>

    <!-- RESULT -->
    <section id="resultCard" class="hidden mt-6 bg-white dark:bg-slate-800 rounded-3xl p-5 sm:p-7 shadow">
      <h2 class="text-xl font-semibold mb-2">–†–µ–∑—É–ª—å—Ç–∞—Ç</h2>
      <p id="resultScore" class="text-2xl font-bold"></p>
      <details class="mt-4">
        <summary class="cursor-pointer">–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</summary>
        <ul id="reviewList" class="mt-3 space-y-3 text-sm"></ul>
      </details>
      <div class="mt-5 flex gap-3">
        <button id="restartBtn" class="rounded-2xl px-4 py-2 shadow bg-indigo-600 text-white">–°–ø—Ä–æ–±—É–≤–∞—Ç–∏ —â–µ —Ä–∞–∑</button>
      </div>
    </section>
  </main>

  <script>
    // --- 50 –Ω–∞–π—É–∂–∏–≤–∞–Ω—ñ—à–∏—Ö —Å–ø–æ–ª—É–∫ ---
const DATA = [
  {verb:'warten', ua:'—á–µ–∫–∞—Ç–∏', prep:'auf', kasus:'Akk'},
  {verb:'tr√§umen', ua:'–º—Ä—ñ—è—Ç–∏', prep:'von', kasus:'Dat'},
  {verb:'sprechen', ua:'–≥–æ–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ', prep:'√ºber', kasus:'Akk'},
  {verb:'sprechen', ua:'–≥–æ–≤–æ—Ä–∏—Ç–∏ –∑', prep:'mit', kasus:'Dat'},
  {verb:'sich √§rgern', ua:'—Å–µ—Ä–¥–∏—Ç–∏—Å—è –Ω–∞', prep:'√ºber', kasus:'Akk'},
  {verb:'sich freuen', ua:'—Ä–∞–¥—ñ—Ç–∏ (–º–∞–π–±—É—Ç–Ω—î)', prep:'auf', kasus:'Akk'},
  {verb:'sich freuen', ua:'—Ä–∞–¥—ñ—Ç–∏ (—Ñ–∞–∫—Ç/—Ç–µ–ø–µ—Ä—ñ—à–Ω—î)', prep:'√ºber', kasus:'Akk'},
  {verb:'sich k√ºmmern', ua:'–ø—ñ–∫–ª—É–≤–∞—Ç–∏—Å—è –ø—Ä–æ', prep:'um', kasus:'Akk'},
  {verb:'danken', ua:'–¥—è–∫—É–≤–∞—Ç–∏ –∑–∞', prep:'f√ºr', kasus:'Akk'},
  {verb:'teilnehmen', ua:'–±—Ä–∞—Ç–∏ —É—á–∞—Å—Ç—å —É', prep:'an', kasus:'Dat'},
  {verb:'bitten', ua:'–ø—Ä–æ—Å–∏—Ç–∏ –ø—Ä–æ', prep:'um', kasus:'Akk'},
  {verb:'erz√§hlen', ua:'—Ä–æ–∑–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø—Ä–æ (–¥–æ—Å–≤—ñ–¥)', prep:'von', kasus:'Dat'},
  {verb:'erz√§hlen', ua:'—Ä–æ–∑–ø–æ–≤—ñ–¥–∞—Ç–∏ –ø—Ä–æ (–∑–∞–≥–∞–ª–æ–º)', prep:'√ºber', kasus:'Akk'},
  {verb:'denken', ua:'–¥—É–º–∞—Ç–∏ –ø—Ä–æ', prep:'an', kasus:'Akk'},
  {verb:'glauben', ua:'–≤—ñ—Ä–∏—Ç–∏ –≤', prep:'an', kasus:'Akk'},
  {verb:'suchen', ua:'—à—É–∫–∞—Ç–∏ (–∫–æ–≥–æ—Å—å/—â–æ—Å—å)', prep:'nach', kasus:'Dat'},
  {verb:'geh√∂ren', ua:'–Ω–∞–ª–µ–∂–∞—Ç–∏ –¥–æ', prep:'zu', kasus:'Dat'},
  {verb:'abh√§ngen', ua:'–∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥', prep:'von', kasus:'Dat'},
  {verb:'sich bewerben', ua:'–ø–æ–¥–∞–≤–∞—Ç–∏—Å—è –Ω–∞', prep:'um', kasus:'Akk'},
  {verb:'sich beschweren', ua:'—Å–∫–∞—Ä–∂–∏—Ç–∏—Å—è –∫–æ–º—É—Å—å', prep:'bei', kasus:'Dat'},
  {verb:'sich beschweren', ua:'—Å–∫–∞—Ä–∂–∏—Ç–∏—Å—è –Ω–∞', prep:'√ºber', kasus:'Akk'},
  {verb:'einladen', ua:'–∑–∞–ø—Ä–æ—à—É–≤–∞—Ç–∏ –Ω–∞/–¥–æ', prep:'zu', kasus:'Dat'},
  {verb:'gratulieren', ua:'–≤—ñ—Ç–∞—Ç–∏ –∑', prep:'zu', kasus:'Dat'},
  {verb:'sich interessieren', ua:'—Ü—ñ–∫–∞–≤–∏—Ç–∏—Å—è', prep:'f√ºr', kasus:'Akk'},
  {verb:'informieren', ua:'—ñ–Ω—Ñ–æ—Ä–º—É–≤–∞—Ç–∏ –ø—Ä–æ', prep:'√ºber', kasus:'Akk'},
  {verb:'sich erkundigen', ua:'–¥—ñ–∑–Ω–∞–≤–∞—Ç–∏—Å—è –ø—Ä–æ', prep:'nach', kasus:'Dat'},
  {verb:'reden', ua:'–±–∞–ª–∞–∫–∞—Ç–∏ –ø—Ä–æ', prep:'√ºber', kasus:'Akk'},
  {verb:'reden', ua:'–±–∞–ª–∞–∫–∞—Ç–∏ –∑', prep:'mit', kasus:'Dat'},
  {verb:'schreiben', ua:'–ø–∏—Å–∞—Ç–∏ –∫–æ–º—É—Å—å', prep:'an', kasus:'Akk'},
  {verb:'schreiben', ua:'–ø–∏—Å–∞—Ç–∏ –ø—Ä–æ', prep:'√ºber', kasus:'Akk'},
  {verb:'helfen', ua:'–¥–æ–ø–æ–º–∞–≥–∞—Ç–∏ —É/–ø—Ä–∏', prep:'bei', kasus:'Dat'},
  {verb:'bestehen', ua:'—Å–∫–ª–∞–¥–∞—Ç–∏—Å—è –∑', prep:'aus', kasus:'Dat'},
  {verb:'bestehen', ua:'–Ω–∞–ø–æ–ª—è–≥–∞—Ç–∏ –Ω–∞', prep:'auf', kasus:'Dat'},
  {verb:'lachen', ua:'—Å–º—ñ—è—Ç–∏—Å—è –∑/–Ω–∞–¥', prep:'√ºber', kasus:'Akk'},
  {verb:'Angst haben', ua:'–±–æ—è—Ç–∏—Å—è', prep:'vor', kasus:'Dat'},
  {verb:'sich vorbereiten', ua:'–≥–æ—Ç—É–≤–∞—Ç–∏—Å—è –¥–æ', prep:'auf', kasus:'Akk'},
  {verb:'verzichten', ua:'–≤—ñ–¥–º–æ–≤–ª—è—Ç–∏—Å—è –≤—ñ–¥', prep:'auf', kasus:'Akk'},
  {verb:'sich entscheiden', ua:'–≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏—Å—è –Ω–∞ –∫–æ—Ä–∏—Å—Ç—å', prep:'f√ºr', kasus:'Akk'},
  {verb:'sich entscheiden', ua:'–≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏—Å—è –ø—Ä–æ—Ç–∏', prep:'gegen', kasus:'Akk'},
  {verb:'sich entschuldigen', ua:'–≤–∏–±–∞—á–∞—Ç–∏—Å—è –ø–µ—Ä–µ–¥', prep:'bei', kasus:'Dat'},
  {verb:'sich entschuldigen', ua:'–≤–∏–±–∞—á–∞—Ç–∏—Å—è –∑–∞', prep:'f√ºr', kasus:'Akk'},
  {verb:'sich gew√∂hnen', ua:'–∑–≤–∏–∫–∞—Ç–∏ –¥–æ', prep:'an', kasus:'Akk'},
  {verb:'zweifeln', ua:'—Å—É–º–Ω—ñ–≤–∞—Ç–∏—Å—è –≤', prep:'an', kasus:'Dat'},
  {verb:'diskutieren', ua:'–¥–∏—Å–∫—É—Ç—É–≤–∞—Ç–∏ –ø—Ä–æ', prep:'√ºber', kasus:'Akk'},
  {verb:'diskutieren', ua:'–¥–∏—Å–∫—É—Ç—É–≤–∞—Ç–∏ –∑', prep:'mit', kasus:'Dat'},
  {verb:'k√§mpfen', ua:'–±–æ—Ä–æ—Ç–∏—Å—è –∑–∞', prep:'f√ºr', kasus:'Akk'},
  {verb:'k√§mpfen', ua:'–±–æ—Ä–æ—Ç–∏—Å—è –ø—Ä–æ—Ç–∏', prep:'gegen', kasus:'Akk'},
  {verb:'arbeiten', ua:'–ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞–¥', prep:'an', kasus:'Dat'},
  {verb:'achten', ua:'–∑–≤–∞–∂–∞—Ç–∏/–∑–≤–µ—Ä—Ç–∞—Ç–∏ —É–≤–∞–≥—É –Ω–∞', prep:'auf', kasus:'Akk'},
  {verb:'ankommen', ua:'–∑–∞–ª–µ–∂–∞—Ç–∏ –≤—ñ–¥ (es kommt ‚Ä¶)', prep:'auf', kasus:'Akk'},
  {verb:'hoffen', ua:'—Å–ø–æ–¥—ñ–≤–∞—Ç–∏—Å—è –Ω–∞', prep:'auf', kasus:'Akk'},
  {verb:'hinweisen', ua:'–≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞', prep:'auf', kasus:'Akk'},
  {verb:'sch√ºtzen', ua:'–∑–∞—Ö–∏—â–∞—Ç–∏ –≤—ñ–¥', prep:'vor', kasus:'Dat'},
  {verb:'retten', ua:'—Ä—è—Ç—É–≤–∞—Ç–∏ –≤—ñ–¥', prep:'vor', kasus:'Dat'},
  {verb:'sich wenden', ua:'–∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—è –¥–æ', prep:'an', kasus:'Akk'},
  {verb:'sich erinnern', ua:'–ø–∞–º‚Äô—è—Ç–∞—Ç–∏/–∑–≥–∞–¥—É–≤–∞—Ç–∏ –ø—Ä–æ', prep:'an', kasus:'Akk'},
  {verb:'sich verlassen', ua:'–ø–æ–∫–ª–∞–¥–∞—Ç–∏—Å—è –Ω–∞', prep:'auf', kasus:'Akk'},
  {verb:'sich besch√§ftigen', ua:'–∑–∞–π–º–∞—Ç–∏—Å—è —á–∏–º–æ—Å—å', prep:'mit', kasus:'Dat'},
  {verb:'sich trennen', ua:'—Ä–æ–∑–ª—É—á–∞—Ç–∏—Å—è/—Ä–æ–∑—Å—Ç–∞–≤–∞—Ç–∏—Å—è –∑', prep:'von', kasus:'Dat'},
  {verb:'sich bedanken', ua:'–¥—è–∫—É–≤–∞—Ç–∏ –∫–æ–º—É—Å—å', prep:'bei', kasus:'Dat'},
  {verb:'sich bedanken', ua:'–¥—è–∫—É–≤–∞—Ç–∏ –∑–∞', prep:'f√ºr', kasus:'Akk'},
  {verb:'sich befreien', ua:'–∑–≤—ñ–ª—å–Ω—è—Ç–∏—Å—è –≤—ñ–¥', prep:'von', kasus:'Dat'},
  {verb:'sich beschr√§nken', ua:'–æ–±–º–µ–∂—É–≤–∞—Ç–∏—Å—è —á–∏–º–æ—Å—å', prep:'auf', kasus:'Akk'},
  {verb:'sich beziehen', ua:'–ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –Ω–∞', prep:'auf', kasus:'Akk'},
  {verb:'sich bekennen', ua:'–≤–∏–∑–Ω–∞–≤–∞—Ç–∏/–¥–µ–∫–ª–∞—Ä—É–≤–∞—Ç–∏ –Ω–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –¥–æ', prep:'zu', kasus:'Dat'},
  {verb:'sich bem√ºhen', ua:'—Å—Ç–∞—Ä–∞—Ç–∏—Å—è/–¥–±–∞—Ç–∏ –ø—Ä–æ', prep:'um', kasus:'Akk'},
  {verb:'sich eignen', ua:'–ø—ñ–¥—Ö–æ–¥–∏—Ç–∏ –¥–ª—è', prep:'f√ºr', kasus:'Akk'},
  {verb:'sich konzentrieren', ua:'–∑–æ—Å–µ—Ä–µ–¥–∂—É–≤–∞—Ç–∏—Å—è –Ω–∞', prep:'auf', kasus:'Akk'},
  {verb:'sich sorgen', ua:'—Ö–≤–∏–ª—é–≤–∞—Ç–∏—Å—è –∑–∞', prep:'um', kasus:'Akk'},
  {verb:'sich verabschieden', ua:'–ø—Ä–æ—â–∞—Ç–∏—Å—è –∑', prep:'von', kasus:'Dat'},
  {verb:'sich verlieben', ua:'–∑–∞–∫–æ—Ö–∞—Ç–∏—Å—è –≤', prep:'in', kasus:'Akk'},
  {verb:'sich wundern', ua:'–¥–∏–≤—É–≤–∞—Ç–∏—Å—è –∑/—á–æ–º—É', prep:'√ºber', kasus:'Akk'},
  {verb:'teilhaben', ua:'–º–∞—Ç–∏ —á–∞—Å—Ç–∫—É/–±—Ä–∞—Ç–∏ —É—á–∞—Å—Ç—å —É', prep:'an', kasus:'Dat'},
  {verb:'sterben', ua:'–ø–æ–º–µ—Ä—Ç–∏ –≤—ñ–¥', prep:'an', kasus:'Dat'},
  {verb:'leiden', ua:'—Å—Ç—Ä–∞–∂–¥–∞—Ç–∏ –Ω–∞ (—Ö–≤–æ—Ä–æ–±—É)', prep:'an', kasus:'Dat'},
  {verb:'leiden', ua:'—Å—Ç—Ä–∞–∂–¥–∞—Ç–∏ –≤—ñ–¥ (—É–º–æ–≤/—Ç–∏—Å–∫—É)', prep:'unter', kasus:'Dat'},
  {verb:'nachdenken', ua:'–æ–±–¥—É–º—É–≤–∞—Ç–∏/—Ä–æ–∑–º—ñ—Ä–∫–æ–≤—É–≤–∞—Ç–∏ –Ω–∞–¥', prep:'√ºber', kasus:'Akk'},
  {verb:'fragen', ua:'–ø–∏—Ç–∞—Ç–∏ –ø—Ä–æ', prep:'nach', kasus:'Dat'},
  {verb:'f√ºhren', ua:'–ø—Ä–∏–∑–≤–æ–¥–∏—Ç–∏ –¥–æ', prep:'zu', kasus:'Dat'},
  {verb:'geraten', ua:'–ø–æ—Ç—Ä–∞–ø–∏—Ç–∏ —É/–≤', prep:'in', kasus:'Akk'},
  {verb:'halten', ua:'–≤–≤–∞–∂–∞—Ç–∏ –∑–∞ (–∫–æ–≥–æ—Å—å/—â–æ—Å—å –∫–∏–º–æ—Å—å)', prep:'f√ºr', kasus:'Akk'},
  {verb:'halten', ua:'–º–∞—Ç–∏ –¥—É–º–∫—É –ø—Ä–æ', prep:'von', kasus:'Dat'},
  {verb:'handeln', ua:'–π—Ç–∏—Å—è –ø—Ä–æ (–±—É—Ç–∏ –ø—Ä–æ)', prep:'von', kasus:'Dat'},
  {verb:'sich handeln', ua:'–π—Ç–∏—Å—è –ø—Ä–æ', prep:'um', kasus:'Akk'},
  {verb:'klagen', ua:'—Å–∫–∞—Ä–∂–∏—Ç–∏—Å—è –Ω–∞', prep:'√ºber', kasus:'Akk'},
  {verb:'kommen', ua:'–ø–æ—Ö–æ–¥–∏—Ç–∏ –∑/–ø—Ä–∏—Ö–æ–¥–∏—Ç–∏ –∑', prep:'aus', kasus:'Dat'},
  {verb:'kommen', ua:'–¥—ñ–π—Ç–∏ –¥–æ/–ø—Ä–∏–∑–≤–µ—Å—Ç–∏ –¥–æ', prep:'zu', kasus:'Dat'},
  {verb:'protestieren', ua:'–ø—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –ø—Ä–æ—Ç–∏', prep:'gegen', kasus:'Akk'},
  {verb:'reagieren', ua:'—Ä–µ–∞–≥—É–≤–∞—Ç–∏ –Ω–∞', prep:'auf', kasus:'Akk'},
  {verb:'riechen', ua:'–ø–∞—Ö–Ω—É—Ç–∏/–≤—ñ–¥–¥–∞–≤–∞—Ç–∏ —á–∏–º–æ—Å—å', prep:'nach', kasus:'Dat'},
  {verb:'sagen', ua:'–≤–∏—Å–ª–æ–≤–ª—é–≤–∞—Ç–∏—Å—è —â–æ–¥–æ', prep:'zu', kasus:'Dat'},
  {verb:'schimpfen', ua:'–ª–∞—è—Ç–∏—Å—è/–Ω–∞—Ä—ñ–∫–∞—Ç–∏ –Ω–∞', prep:'√ºber', kasus:'Akk'},
  {verb:'sich sehnen', ua:'—Ç—É–∂–∏—Ç–∏/—Å—É–º—É–≤–∞—Ç–∏ –∑–∞', prep:'nach', kasus:'Dat'},
  {verb:'sich streiten', ua:'—Å–ø–µ—Ä–µ—á–∞—Ç–∏—Å—è –ø—Ä–æ', prep:'√ºber', kasus:'Akk'},
  {verb:'sich streiten', ua:'—Å–ø–µ—Ä–µ—á–∞—Ç–∏—Å—è –∑', prep:'mit', kasus:'Dat'},
  {verb:'sich streiten', ua:'—Å–≤–∞—Ä–∏—Ç–∏—Å—è –∑–∞ (—Ä–µ—Å—É—Ä—Å)', prep:'um', kasus:'Akk'},
  {verb:'sich unterhalten', ua:'—Ä–æ–∑–º–æ–≤–ª—è—Ç–∏ –ø—Ä–æ', prep:'√ºber', kasus:'Akk'},
  {verb:'sich unterhalten', ua:'—Å–ø—ñ–ª–∫—É–≤–∞—Ç–∏—Å—è –∑', prep:'mit', kasus:'Dat'},
  {verb:'telefonieren', ua:'—Ç–µ–ª–µ—Ñ–æ–Ω—É–≤–∞—Ç–∏ –∑', prep:'mit', kasus:'Dat'},
  {verb:'warnen', ua:'–ø–æ–ø–µ—Ä–µ–¥–∂–∞—Ç–∏ –ø—Ä–æ/–≤—ñ–¥', prep:'vor', kasus:'Dat'}
];

    const ALL_PREPS = ['auf','an','√ºber','mit','von','f√ºr','um','in','nach','zu','bei','aus','vor','gegen'];

    // === –ü–†–û–ì–†–ï–° –ö–û–†–ò–°–¢–£–í–ê–ß–ê (localStorage) ===
    const STREAKS_KEY = 'vmpp_streaks_v1'; // { 'verb|prep': number }
    const MISTAKES_KEY = 'vmpp_mistakes_v1'; // Array of questions
    const MASTERED_THRESHOLD = 3; // –ø—ñ—Å–ª—è 3 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö ‚Äî –≤–∏–∫–ª—é—á–∞—Ç–∏

    function getStreaks(){ try { return JSON.parse(localStorage.getItem(STREAKS_KEY)||'{}'); } catch(e){ return {}; } }
    function setStreaks(obj){ localStorage.setItem(STREAKS_KEY, JSON.stringify(obj)); }
    function getMistakes(){ try { return JSON.parse(localStorage.getItem(MISTAKES_KEY)||'[]'); } catch(e){ return []; } }
    function setMistakes(arr){ localStorage.setItem(MISTAKES_KEY, JSON.stringify(arr)); }
    function keyOf(q){ return q.verb+'|'+q.prep; }
    function upsertStreak(q, ok){
      const k = keyOf(q); const st = getStreaks();
      if(ok){ st[k] = (st[k]||0) + 1; } else { st[k] = 0; }
      setStreaks(st);
    }
    function addMistake(q){ const m = getMistakes(); if(!m.some(x=>x.verb===q.verb && x.prep===q.prep)){ m.push(q); setMistakes(m);} }
    function removeMistake(q){ const m = getMistakes().filter(x=> !(x.verb===q.verb && x.prep===q.prep)); setMistakes(m); }
    function isMastered(q){ const st = getStreaks(); return (st[keyOf(q)]||0) >= MASTERED_THRESHOLD; }

    let quiz = [];
    let idx = 0;
    let correct = 0;
    let userAnswers = [];

    const setupCard = document.getElementById('setupCard');
    const quizCard = document.getElementById('quizCard');
    const resultCard = document.getElementById('resultCard');
    const questionCount = document.getElementById('questionCount');
    const startBtn = document.getElementById('startBtn');
    const repeatMistakesBtn = document.getElementById('repeatMistakesBtn');
    const resetProgressBtn = document.getElementById('resetProgressBtn');
    const progress = document.getElementById('progress');
    const scoreMini = document.getElementById('scoreMini');
    const promptEl = document.getElementById('prompt');
    const optionsEl = document.getElementById('options');
    const feedback = document.getElementById('feedback');
    const resultScore = document.getElementById('resultScore');
    const reviewList = document.getElementById('reviewList');
    const restartBtn = document.getElementById('restartBtn');
    const masteredInfo = document.getElementById('masteredInfo');

    function shuffle(arr){ return arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]); }

    function sampleQuestions(n){
      const pool = shuffle([...DATA]);
      return pool.slice(0, Math.min(n, pool.length));
    }

    function makeOptions(correctPrep){
      const distractors = shuffle(ALL_PREPS.filter(p=>p!==correctPrep)).slice(0,4);
      return shuffle([correctPrep, ...distractors]);
    }

    function disableOptions(){
      document.querySelectorAll('input[name="opt"]').forEach(r=>r.disabled = true);
    }

    function renderQuestion(){
      const q = quiz[idx];
      progress.textContent = (idx+1) + ' / ' + quiz.length;
      scoreMini.textContent = '‚úÖ ' + correct;
      const st = getStreaks()[keyOf(q)] || 0;
      const star = st >= MASTERED_THRESHOLD ? ' ‚≠ê' : '';
      promptEl.innerHTML = '<span class="font-semibold">' + q.verb + '</span> ' +
        '<span class="text-slate-500">(' + q.ua + ')</span> ‚Äî ' +
        '<span class="inline-flex items-center rounded-full px-3 py-1 text-sm font-medium bg-slate-100 dark:bg-slate-700">' + q.kasus + '</span>' +
        (st ? ' <span class="ml-2 text-xs text-slate-500">—Å–µ—Ä—ñ—è: ' + st + star + '</span>' : '');

      const opts = makeOptions(q.prep);
      optionsEl.innerHTML = '';
      opts.forEach(function(p, i){
        const id = 'opt-' + idx + '-' + i;
        const input = document.createElement('input');
        input.type = 'radio';
        input.name = 'opt';
        input.id = id;
        input.value = p;
        input.className = 'hidden peer';

        const label = document.createElement('label');
        label.setAttribute('for', id);
        label.className = 'flex items-center justify-center rounded-2xl px-4 py-2 shadow bg-slate-100 dark:bg-slate-700 peer-checked:ring-2 ring-indigo-500';
        label.textContent = p;

        input.addEventListener('change', function(){ handleChoice(p); });

        const wrap = document.createElement('div');
        wrap.appendChild(input);
        wrap.appendChild(label);
        optionsEl.appendChild(wrap);
      });

      feedback.classList.add('hidden');
      feedback.textContent = '';
      feedback.className = 'hidden mt-4 rounded-2xl border p-3';
    }

    function grade(chosenValue){
      const q = quiz[idx];
      const ok = chosenValue === q.prep;
      userAnswers.push({q, chosen: chosenValue, correct: ok});
      disableOptions();

      // –æ–Ω–æ–≤–∏—Ç–∏ —Å–µ—Ä—ñ—é —ñ —Å–ø–∏—Å–æ–∫ –ø–æ–º–∏–ª–æ–∫
      upsertStreak(q, ok);
      if(ok){ removeMistake(q); } else { addMistake(q); }

      if(ok){
        correct++;
        feedback.className = 'mt-4 rounded-2xl border p-3 bg-green-50 dark:bg-green-900/20 border-green-300';
        const st = (getStreaks()[keyOf(q)]||0);
        feedback.innerHTML = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! <b>' + q.verb + '</b> ‚Üí <b>' + q.prep + '</b> + ' + q.kasus +
          (st >= MASTERED_THRESHOLD ? '<br><span class="text-emerald-700">‚≠ê –ó–∞—Å–≤–æ—î–Ω–æ: 3 –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –ø–æ—Å–ø—ñ–ª—å ‚Äî —Ü–µ —Å–ª–æ–≤–æ –±—É–¥–µ –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ –≤ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö —Å–µ—Å—ñ—è—Ö.</span>' : '<br><span class="text-slate-600">–°–µ—Ä—ñ—è: ' + st + '</span>');
      } else {
        feedback.className = 'mt-4 rounded-2xl border p-3 bg-rose-50 dark:bg-rose-900/20 border-rose-300';
        feedback.innerHTML = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ. –ü—Ä–∞–≤–∏–ª—å–Ω–æ: <b>' + q.verb + '</b> ‚Üí <b>' + q.prep + '</b> + ' + q.kasus +
          '<br><span class="text-rose-700">–°–µ—Ä—ñ—è —Å–∫–∏–Ω—É—Ç–∞ –¥–æ 0 ‚Äî —Å–ª–æ–≤–æ –∑–Ω–æ–≤—É —Ç—Ä–µ–Ω—É—î—Ç—å—Å—è.</span>';
      }
      feedback.classList.remove('hidden');
    }

    function handleChoice(val){
      grade(val);
      setTimeout(function(){
        idx++;
        if(idx < quiz.length){
          renderQuestion();
        } else {
          finish();
        }
      }, 1500);
    }

    function updateMasteredInfo(){
      const st = getStreaks();
      const mastered = Object.values(st).filter(v=> v >= MASTERED_THRESHOLD).length;
      masteredInfo.textContent = mastered ? `–ó–∞—Å–≤–æ—î–Ω–æ (–ø—Ä–∏—Ö–æ–≤–∞–Ω–æ): ${mastered}` : '';
    }

    function finish(){
      quizCard.classList.add('hidden');
      resultCard.classList.remove('hidden');
      const pct = Math.round((correct/quiz.length)*100);
      let color = 'text-rose-600';
      if(pct >= 95) color = 'text-emerald-600';
      else if(pct >= 75) color = 'text-amber-600';
      resultScore.className = 'text-2xl font-bold ' + color;
      resultScore.textContent = '–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ' + correct + ' / ' + quiz.length + ' (' + pct + '%)';

      reviewList.innerHTML = '';
      userAnswers.forEach(function(it, i){
        const li = document.createElement('li');
        const right = it.correct ? '‚úÖ' : '‚ùå';
        li.innerHTML = right + ' <b>' + (i+1) + '.</b> ' + it.q.verb + ' <span class="text-slate-500">(' + it.q.ua + ')</span> ‚Äî ' + it.q.kasus + '<br>' +
          '<span class="ml-6">–¢–≤—ñ–π –≤–∏–±—ñ—Ä: <b>' + it.chosen + '</b> ¬∑ –ü—Ä–∞–≤–∏–ª—å–Ω–æ: <b>' + it.q.prep + '</b></span>';
        li.className = 'rounded-xl border border-slate-200 dark:border-slate-700 p-3';
        reviewList.appendChild(li);
      });
      updateMasteredInfo();
    }

    // Start: 1) –ø–æ–º–∏–ª–∫–∏ –ø–µ—Ä—à–∏–º–∏ 2) –≤–∏–∫–ª—é—á–∏—Ç–∏ –∑–∞—Å–≤–æ—î–Ω—ñ (>=3)
    startBtn.addEventListener('click', function(){
      const n = parseInt(questionCount.value, 10);
      const mistakes = getMistakes();
      const pool = DATA.filter(d=> !isMastered(d));
      let combined = shuffle(mistakes.concat(pool.filter(d=> !mistakes.some(m=> m.verb===d.verb && m.prep===d.prep))));
      if(combined.length === 0){ combined = shuffle([...DATA]); }
      quiz = combined.slice(0, Math.min(n, combined.length));

      idx = 0; correct = 0; userAnswers = [];
      setupCard.classList.add('hidden');
      resultCard.classList.add('hidden');
      quizCard.classList.remove('hidden');
      renderQuestion();
    });

    restartBtn.addEventListener('click', function(){
      setupCard.classList.remove('hidden');
      resultCard.classList.add('hidden');
      updateMasteredInfo();
    });

    // –ü–æ–≤—Ç–æ—Ä–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ –ø–æ–º–∏–ª–∫–∏
    repeatMistakesBtn.addEventListener('click', function(){
      const mistakes = getMistakes();
      if(!mistakes.length){ alert('–ù–µ–º–∞—î –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è ‚Äî –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ! ‚úÖ'); return; }
      quiz = shuffle(mistakes);
      idx = 0; correct = 0; userAnswers = [];
      setupCard.classList.add('hidden');
      resultCard.classList.add('hidden');
      quizCard.classList.remove('hidden');
      renderQuestion();
    });

    // –°–∫–∏–Ω—É—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å (—Å–µ—Ä—ñ—ó —Ç–∞ –ø–æ–º–∏–ª–∫–∏)
    resetProgressBtn.addEventListener('click', function(){
      if(confirm('–°–∫–∏–Ω—É—Ç–∏ —É—Å—ñ —Å–µ—Ä—ñ—ó –π –ø–æ–º–∏–ª–∫–∏? –¶—é –¥—ñ—é –Ω–µ –º–æ–∂–Ω–∞ –≤—ñ–¥–º—ñ–Ω–∏—Ç–∏.')){
        localStorage.removeItem(STREAKS_KEY);
        localStorage.removeItem(MISTAKES_KEY);
        alert('–ü—Ä–æ–≥—Ä–µ—Å –æ—á–∏—â–µ–Ω–æ. –í—Å—ñ —Å–ª–æ–≤–∞ –∑–Ω–æ–≤—É –≤ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—ñ.');
        updateMasteredInfo();
      }
    });

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –ª—ñ—á–∏–ª—å–Ω–∏–∫–∞ –∑–∞—Å–≤–æ—î–Ω–∏—Ö
    updateMasteredInfo();
  </script>
</body>
</html>
